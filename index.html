<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>自然大叔｜冷氣・洗衣機・水塔・自來水管清洗</title>
  <meta name="description" content="專業到府清洗：冷氣、直立式洗衣機、水塔、自來水管。透明價格、到府快速、提供保固與發票。立即以 LINE/電話預約。" />
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Favicon / Icons -->
  <link rel="icon" type="image/png" href="logo-mark.jpg" sizes="32x32">
  <link rel="apple-touch-icon" href="logo-mark.jpg" sizes="180x180">

  <!-- Open Graph -->
  <meta property="og:title" content="自然大叔｜冷氣・洗衣機・水塔・自來水管清洗">
  <meta property="og:description" content="專業到府清洗｜透明價格｜完工保固｜可開立發票">
  <meta property="og:image" content="og.jpg">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://yourdomain.com/">

  <!-- 圖片供應商預連線（用到哪個就留哪個） -->
  <link rel="preconnect" href="https://res.cloudinary.com" crossorigin>
  <link rel="preconnect" href="https://ik.imagekit.io" crossorigin>
  <link rel="preconnect" href="https://ucarecdn.com" crossorigin>
  <link rel="preconnect" href="https://imagedelivery.net" crossorigin>

  <!-- 結構化資料 -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"CleaningService",
    "name":"自然大叔",
    "image":"assets/logo-mark.jpg",
    "url":"https://yourdomain.com",
    "telephone":"+886-912-356-331",
    "priceRange":"$$",
    "areaServed":"台北、新北、基隆",
    "openingHours":"Mo-Sa 09:00-20:00",
    "sameAs":["https://line.me/R/ti/p/@uncle888"],
    "serviceType":["冷氣清洗","直立式洗衣機清洗","水塔清洗","自來水管清洗"],
    "address": {
      "@type":"PostalAddress",
      "addressLocality":"台北市",
      "addressRegion":"台北市",
      "postalCode":"100",
      "addressCountry":"TW"
    },
    "potentialAction":{
      "@type":"ReserveAction",
      "target":"https://yourdomain.com/booking",
      "result":{"@type":"Reservation","name":"家電清洗預約"}
    }
  }
  </script>

  <style>
    html{scroll-behavior:smooth}
    /* 主題 */
    :root{
      --bg:#f3f5f9; --text:#0b1220; --muted:#5b6b7f;
      --card-bg:#ffffff; --border:#d7deea;
      --primary:#06C755; --primary-hover:#05b451;
      --accent:#2563eb; --text-strong:#0a0f1a;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b1220; --text:#e7edf6; --muted:#afbbce;
        --card-bg:#0f172a; --border:#233046;
        --accent:#60a5fa; --text-strong:#ffffff;
      }
    }
    body[data-theme]{
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(37,99,235,.12), transparent 60%),
        radial-gradient(1000px 500px at 90% -20%, rgba(6,199,85,.12), transparent 55%),
        linear-gradient(#f6f8fc, #eef2f8);
      color:var(--text);
    }
    body.dark[data-theme]{
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(96,165,250,.20), transparent 60%),
        radial-gradient(1000px 500px at 90% -20%, rgba(6,199,85,.18), transparent 55%),
        linear-gradient(#0f172a, #0b1220);
    }

    .muted{color:var(--muted)}
    h1,h2,h3{ color:var(--text-strong) }
    h1{ font-weight:800 } h2{ font-weight:800 } h3{ font-weight:700 }
    .card{background:var(--card-bg);border:1px solid var(--border);border-radius:1rem;padding:1.25rem;box-shadow:0 6px 20px rgba(15,23,42,.06)}
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:.75rem 1.25rem;border-radius:.75rem;font-weight:600;transition:transform .15s ease,background-color .2s ease,box-shadow .2s ease}
    .btn:hover{transform:scale(1.05)}
    .btn-primary{background:var(--accent);color:#fff}
    .btn-primary:hover{background:#1d4ed8}
    .btn-ghost{background:#fff;border:1px solid #c9d3e3;color:var(--text)}
    .reveal{opacity:0;transform:translateY(16px);transition:opacity .6s ease,transform .6s ease}
    .reveal.visible{opacity:1;transform:translateY(0)}

    header{ background:rgba(255,255,255,.88); backdrop-filter:saturate(1.1) blur(8px); border-color:var(--border) !important; box-shadow:0 2px 12px rgba(2,6,23,.04) }

    /* 單張工作照（含合成圖） */
    .work-photo{
      position:relative; border-radius:1rem; overflow:hidden;
      border:1px solid var(--border); background:var(--card-bg);
      aspect-ratio: 16 / 9;
    }
    .work-photo img{
      width:100%; height:100%; object-fit:cover; display:block;
    }
    .work-photo .hint{
      position:absolute; right:.5rem; bottom:.5rem; z-index:2;
      background:rgba(0,0,0,.55); color:#fff; font-size:.75rem;
      padding:.25rem .5rem; border-radius:.5rem;
    }

    /* 放大檢視（dialog lightbox） */
    #imgViewer::backdrop{ background:rgba(0,0,0,.65) }
    #imgViewer{ border:0; padding:0; background:transparent; max-width:90vw; max-height:90vh }
    #imgViewer img{ width:100%; height:100%; object-fit:contain; background:#000 }
    #imgViewer .close{ position:absolute; top:.5rem; right:.5rem; background:rgba(0,0,0,.6); color:#fff; border:0; border-radius:.5rem; padding:.25rem .5rem; cursor:pointer }
  </style>
</head>

<body id="top" data-theme>
  <!-- Header -->
  <header class="bg-white/90 sticky top-0 backdrop-blur z-50 border-b">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="#top" class="flex items-center gap-3">
        <img src="logo-horizontal.png" alt="自然大叔 Natural Uncle" class="h-12 w-auto">
        <span class="sr-only">自然大叔 Natural Uncle</span>
      </a>

      <nav class="hidden md:flex gap-6 text-sm">
        <a href="#services">服務項目</a>
        <a href="#pricing">價格方案</a>
        <a href="#process">施工流程</a>
        <a href="#ac-sop">冷氣SOP</a>
        <a href="#cases">工作日誌</a>
        <a href="#faq">常見問題</a>
        <a href="#contact">聯絡預約</a>
      </nav>

      <a href="https://line.me/R/ti/p/@uncle888" class="hidden md:inline-flex btn btn-primary">LINE 諮詢</a>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative bg-gradient-to-b from-sky-50 to-white">
    <div class="max-w-6xl mx-auto px-4 py-14 text-center">
      <h1 class="text-3xl md:text-5xl font-extrabold">冷氣・洗衣機・水塔・自來水管 到府專業清洗</h1>
      <p class="mt-4 text-lg muted">透明價格｜完工保固｜環保清潔劑｜可開立發票</p>
      <div class="mt-6 flex flex-col sm:flex-row gap-3 justify-center">
        <a href="tel:+886912356331" class="btn btn-ghost">一鍵撥打</a>
        <a href="https://line.me/R/ti/p/@uncle888" class="btn btn-primary">LINE 立即預約</a>
      </div>
      <ul class="mt-6 flex flex-wrap gap-3 justify-center text-sm muted">
        <li>累積服務 2,000+ 戶</li><li>到府 2–3 小時完工</li><li>設備保護與現場防護處理</li>
      </ul>
    </div>
  </section>

  <!-- 服務項目 -->
  <section id="services" class="max-w-6xl mx-auto px-4 py-12 reveal">
    <h2 class="text-2xl md:text-3xl font-bold mb-6">服務項目</h2>
    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
      <div class="card"><h3 class="font-bold">冷氣清洗</h3><p class="muted text-sm mt-2">清洗蒸發器、風鼓、濾網，防水防護處理。</p><a href="#ac-sop" class="btn btn-ghost mt-3">查看完整 SOP →</a></div>
      <div class="card"><h3 class="font-bold">直立式洗衣機清洗</h3><p class="muted text-sm mt-2">全機拆洗除黴與水垢，還原洗淨力。</p></div>
      <div class="card"><h3 class="font-bold">水塔清洗</h3><p class="muted text-sm mt-2">排空、刷洗，附清洗照片存證。</p></div>
      <div class="card"><h3 class="font-bold">自來水管清洗</h3><p class="muted text-sm mt-2">脈衝清洗去除鏽垢，改善黃水/水壓不穩。</p></div>
    </div>
  </section>

  <!-- 透明價格 -->
  <section id="pricing" class="bg-slate-50 reveal">
    <div class="max-w-6xl mx-auto px-4 py-12">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl md:text-3xl font-bold">透明價格</h2>
        <a href="pricing.html" class="text-sm underline text-sky-700">查看完整價格細項</a>
      </div>
      <div class="overflow-x-auto">
        <table class="w-full text-left text-sm">
          <thead><tr class="border-b">
            <th class="py-3">項目</th><th>基本價格</th><th>加購/加價</th><th>備註</th><th class="sr-only">細項</th></tr></thead>
          <tbody>
            <tr class="border-b"><td class="py-3">冷氣（分離式/台）</td><td>$1,800 起</td><td>加大加長款、特殊機款</td><td>含防護與清潔劑</td><td><a href="pricing.html#ac" class="btn btn-ghost py-2 px-3 text-xs" aria-label="查看冷氣清洗價格細項">細項</a></td></tr>
            <tr class="border-b"><td class="py-3">洗衣機（直立式）</td><td>$2,000 起</td><td>無</td><td>全機拆洗殺菌</td><td><a href="pricing.html#wm" class="btn btn-ghost py-2 px-3 text-xs" aria-label="查看洗衣機清洗價格細項">細項</a></td></tr>
            <tr class="border-b"><td class="py-3">家用水塔</td><td>$1,000 起</td><td>大容量另計</td><td>附清洗照片</td><td><a href="pricing.html#tank" class="btn btn-ghost py-2 px-3 text-xs" aria-label="查看水塔清洗價格細項">細項</a></td></tr>
            <tr><td class="py-3">自來水管</td><td>$3,200 起</td><td>多重管線</td><td>改善黃水/水壓</td><td><a href="pricing.html#pipe" class="btn btn-ghost py-2 px-3 text-xs" aria-label="查看自來水管清洗價格細項">細項</a></td></tr>
          </tbody>
        </table>
      </div>
      <p class="mt-4 text-sm muted">＊可先 LINE 傳照片快速報價，實際費用以現場與機型為準。</p>
    </div>
  </section>

  <!-- 施工流程（節錄） -->
  <section id="process" class="max-w-6xl mx-auto px-4 py-12 reveal">
    <h2 class="text-2xl md:text-3xl font-bold mb-6">施工流程</h2>
    <div class="grid md:grid-cols-2 gap-8">
      <div class="p-5 rounded-2xl border">
        <div class="timeline">
          <div class="timeline-item"><h3 class="font-semibold">步驟 1｜線上估價與預約</h3><p class="muted text-sm mt-1">LINE 洽詢清洗事宜、設備照片，安排時段並確認費用區間。</p></div>
          <div class="timeline-item"><h3 class="font-semibold">步驟 2｜到府前防護與檢查</h3><p class="muted text-sm mt-1">鋪設養生膠帶保護；實機測試功能、觀察機況、風量與溫差。</p></div>
          <div class="timeline-item"><h3 class="font-semibold">步驟 3｜拆機與深度清洗</h3><p class="muted text-sm mt-1">清洗熱交換器、風鼓、導風坡道、濾網與集水盤、疏通排水孔；環保藥劑不傷材。</p></div>
          <div class="timeline-item"><h3 class="font-semibold">步驟 4｜組裝回測與漏水檢查</h3><p class="muted text-sm mt-1">恢復裝機、運轉測試、檢查機況/滴水，確認運作穩定。</p></div>
          <div class="timeline-item"><h3 class="font-semibold">步驟 5｜收尾清場與保固說明</h3><p class="muted text-sm mt-1">現場清潔、提供照片與保養貼紙，說明 14 天保固內容。</p></div>
        </div>
      </div>
      <div class="card">
        <h3 class="font-bold">到府前準備</h3>
        <details class="reveal" open>
          <summary class="font-semibold cursor-pointer">冷氣施工</summary>
          <div class="mt-3 muted text-sm">可提前清出室內機下方空間以便擺放 A 字梯；大型家具視情況協助判斷是否可移動。</div>
        </details>
        <details class="reveal"><summary class="font-semibold cursor-pointer">直立式洗衣機施工</summary><div class="mt-3 text-sm muted"><ul class="list-disc ml-5"><li>先清空內桶與上蓋置物。</li><li>狹窄陽台/浴室可先拍照提供，加快評估。</li></ul></div></details>
      </div>
    </div>
  </section>

  <!-- ★ 工作照片日誌（單張顯示） -->
  <section id="cases" class="max-w-6xl mx-auto px-4 py-12 reveal">
    <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3 mb-6">
      <div>
        <h2 class="text-2xl md:text-3xl font-bold">工作照片日誌｜每日更新</h2>
        <p class="muted text-sm mt-1">顯示每次清洗的成果照片（<span id="workCount">0</span> 筆）</p>
      </div>
      <div class="flex flex-col sm:flex-row gap-2">
        <select id="filterService" class="btn btn-ghost py-2 px-3">
          <option value="all">全部服務</option>
          <option value="冷氣">冷氣清洗</option>
          <option value="洗衣機">直立式洗衣機清洗</option>
          <option value="水塔">水塔清洗</option>
          <option value="水管">自來水管清洗</option>
        </select>
        <select id="filterDate" class="btn btn-ghost py-2 px-3">
          <option value="7">近 7 天</option>
          <option value="30">近 30 天</option>
          <option value="1">本日</option>
          <option value="all">全部</option>
        </select>
        <input id="filterKeyword" class="btn btn-ghost py-2 px-3" placeholder="關鍵字（區域/備註）" />
      </div>
    </div>

    <div id="workGrid" class="grid md:grid-cols-2 gap-6"></div>

    <div class="mt-6 text-center">
      <button id="btnMore" class="btn btn-primary px-6">載入更多</button>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="bg-slate-50 reveal">
    <div class="max-w-6xl mx-auto px-4 py-12">
      <h2 class="text-2xl md:text-3xl font-bold mb-6">常見問題</h2>
      <details class="card"><summary class="font-semibold cursor-pointer">清洗會不會弄髒室內？</summary><div class="mt-3 text-sm muted">作業前會做防護與遮蔽，完工會收拾乾淨。</div></details>
      <details class="card mt-3"><summary class="font-semibold cursor-pointer">多久清一次？</summary><div class="mt-3 text-sm muted">一般家用 1–2 年一次；過敏/寵物家庭可縮短。</div></details>
    </div>
  </section>

  <!-- 聯絡 / 預約 -->
  <section id="contact" class="max-w-6xl mx-auto px-4 py-12 reveal">
    <h2 class="text-2xl md:text-3xl font-bold mb-6">聯絡 / 預約</h2>
    <div class="grid md:grid-cols-2 gap-6 items-start">
      <div class="p-5 rounded-2xl border">
        <h3 class="font-bold">快速通道</h3>
        <ul class="mt-3 text-sm">
          <li>電話：<a href="tel:+886912356331" class="text-sky-700 underline">+886 912-356-331</a></li>
          <li>LINE：<a href="https://line.me/R/ti/p/@uncle888" class="text-sky-700 underline">@uncle888</a></li>
          <li>服務時間：週一至週六 09:00–20:00</li>
        </ul>
        <a href="https://yourdomain.com/booking" class="btn btn-primary mt-4 w-full sm:w-auto">立即線上預約</a>
      </div>
      <div class="p-5 rounded-2xl border">
        <h3 class="font-bold">服務資訊</h3>
        <ul class="mt-3 text-sm">
          <li>服務範圍：皆可服務（除宜、花、東、屏）</li>
          <li>可附照片估價／可開立發票／14 天售後保固</li>
          <li>施工前請確保水電正常供應，並協助保留必要空間</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-white border-t">
    <div class="max-w-6xl mx-auto px-4 py-8 text-sm muted flex items-center gap-3">
      <img src="logo-mark.jpg" alt="" class="h-10 w-auto opacity-80" loading="lazy" width="96" height="96">
      <span>© <span id="year"></span> 自然大叔 Natural Uncle｜統編：88537528</span>
    </div>
  </footer>

  <!-- 圖片放大檢視 -->
  <dialog id="imgViewer">
    <button class="close" aria-label="關閉">✕</button>
    <img alt="work photo">
  </dialog>

  <!-- 主腳本：滾動動畫 + 工作日誌（單張顯示版） -->
  <script>
    /* 年份自動更新 */
    document.getElementById('year').textContent = new Date().getFullYear();

    /* 滾動進場動畫 */
    const observer = new IntersectionObserver((entries)=>{ entries.forEach(entry=>{ if(entry.isIntersecting){ entry.target.classList.add('visible'); observer.unobserve(entry.target); } }) }, {threshold:0.12});
    document.querySelectorAll('.reveal').forEach(el=>observer.observe(el));

    /* 圖片供應商設定 */
    const CONFIG = {
      manifestPath: '/works/manifest.json',
      cloudinary: { cloudName: 'dijzndzw2' }, // ← 改成你的 Cloudinary 名稱
      imagekit:   { baseUrl: 'https://ik.imagekit.io/YOUR_IMAGEKIT_ID' },
      uploadcare: { baseCdn: 'https://ucarecdn.com' },
      cloudflare: { accountHash: 'YOUR_ACCOUNT_HASH', variant: 'public' }
    };

    /* 小工具 */
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    function daysBetween(d){ const ms=(new Date())-new Date(d+'T00:00:00'); return Math.floor(ms/86400000); }
    function matchKeyword(w,kw){ if(!kw) return true; kw=kw.trim(); return [w.city,w.area,w.service,w.note].some(x=>(x||'').includes(kw)); }

    /* 產生最佳化圖片 URL */
    function buildUrl(provider, idOrUrl, width=1600){
      if(!idOrUrl) return '';
      if(/^https?:\/\//i.test(idOrUrl)) return idOrUrl;
      switch((provider||'').toLowerCase()){
        case 'cloudinary': {
          const c = CONFIG.cloudinary.cloudName;
          const publicId = idOrUrl.split('/').map(encodeURIComponent).join('/'); // 保留資料夾斜線
          return `https://res.cloudinary.com/${c}/image/upload/f_auto,q_auto,w_${width}/${publicId}`;
        }
        case 'imagekit': {
          const base = CONFIG.imagekit.baseUrl.replace(/\/$/,'');
          return `${base}/${idOrUrl}?tr=f-auto,q-85,w-${width}`;
        }
        case 'uploadcare': {
          const cdn = CONFIG.uploadcare.baseCdn.replace(/\/$/,'');
          return `${cdn}/${idOrUrl}/-/format/auto/-/quality/smart/-/resize/${width}/`;
        }
        case 'cloudflare': {
          const { accountHash, variant } = CONFIG.cloudflare;
          return `https://imagedelivery.net/${accountHash}/${encodeURIComponent(idOrUrl)}/${encodeURIComponent(variant)}`;
        }
        default: return idOrUrl;
      }
    }

    /* 卡片模板（單張顯示：優先 collage → after → before） */
    function workCard(w){
      const when = daysBetween(w.date)===0 ? '（本日）' : '';
      const title = `${w.date}${when}・${w.city||''}${w.area||''}・${w.service||''}`;
      const prov = (w.provider || 'url').toLowerCase();

      const src = w.collage ? buildUrl(prov, w.collage)
                : (w.after ? buildUrl(prov, w.after)
                : buildUrl(prov, w.before));
      const alt = `${w.city||''}${w.area||''}${w.service||''} 清洗成果`;

      return `
      <article class="card p-0 overflow-hidden">
        <div class="p-4 border-b flex items-center justify-between">
          <div class="text-sm font-semibold">${title}</div>
          <span class="text-xs muted">${w.id||''}</span>
        </div>
        <div class="p-4">
          <figure class="work-photo" data-full="${src}">
            <img src="${src}" alt="${alt}" loading="lazy" width="1600" height="900">
            <figcaption class="hint">點圖放大</figcaption>
          </figure>
          ${w.note ? `<p class="mt-3 text-sm muted">${w.note}</p>` : ''}
        </div>
      </article>`;
    }

    /* 狀態與流程 */
    let ALL_WORKS = [], currentFiltered = [];
    let pageSize = 8, page = 1;

    async function loadWorks(){
      try{
        const res = await fetch(CONFIG.manifestPath + '?v=' + Date.now(), { cache:'no-store' });
        if(!res.ok) throw new Error('manifest 載入失敗');
        const data = await res.json();
        if(!Array.isArray(data)) throw new Error('manifest 應為陣列');

        ALL_WORKS = data.map(x => ({
          id: x.id || crypto.randomUUID(),
          date: x.date || new Date().toISOString().slice(0,10),
          service: x.service || '',
          city: x.city || '',
          area: x.area || '',
          note: x.note || '',
          provider: (x.provider || 'url').toLowerCase(),
          before: x.before,
          after:  x.after,
          collage: x.collage
        }));
      }catch(e){
        console.error(e);
        ALL_WORKS = [];
      }
    }

    function applyFilters(){
      const svc = $('#filterService')?.value || 'all';
      const range = $('#filterDate')?.value || '7';
      const kw = $('#filterKeyword')?.value || '';

      const filtered = ALL_WORKS
        .filter(w => svc==='all' ? true : w.service===svc)
        .filter(w => {
          if(range==='all') return true;
          if(range==='1')  return daysBetween(w.date) <= 0;
          if(range==='7')  return daysBetween(w.date) <= 7;
          if(range==='30') return daysBetween(w.date) <= 30;
          return true;
        })
        .filter(w => matchKeyword(w, kw))
        .sort((a,b) => b.date.localeCompare(a.date));

      currentFiltered = filtered;
      const cnt = $('#workCount'); if(cnt) cnt.textContent = filtered.length;
      page = 1;
      renderPage();
    }

    function renderPage(){
      const grid = $('#workGrid');
      if(!grid) return;

      if(currentFiltered.length===0){
        grid.innerHTML = `<div class="muted text-sm">目前尚無工作日誌，請稍後再來看看。</div>`;
        $('#btnMore')?.classList.add('is-hidden');
        return;
      }

      const slice = currentFiltered.slice(0, page*pageSize);
      grid.innerHTML = slice.map(workCard).join('');
      initViewerLinks();

      const more = $('#btnMore');
      if(more){
        if(slice.length >= currentFiltered.length){ more.classList.add('is-hidden'); }
        else { more.classList.remove('is-hidden'); }
      }
    }

    /* 點圖放大 */
    function initViewerLinks(){
      const dlg = document.getElementById('imgViewer');
      if(!dlg) return;
      const img = dlg.querySelector('img');
      const close = dlg.querySelector('.close');

      document.addEventListener('click', (e)=>{
        const fig = e.target.closest && e.target.closest('.work-photo');
        if(!fig) return;
        const url = fig.getAttribute('data-full');
        img.src = url; img.alt = 'work photo';
        dlg.showModal();
      });

      close.addEventListener('click', ()=> dlg.close());
      dlg.addEventListener('click', (e)=>{ if(e.target === dlg) dlg.close(); });
    }

    async function initDiary(){
      await loadWorks();
      $('#filterService')?.addEventListener('change', applyFilters);
      $('#filterDate')?.addEventListener('change', applyFilters);
      $('#filterKeyword')?.addEventListener('input', ()=>{ applyFilters(); });
      $('#btnMore')?.addEventListener('click', ()=>{ page += 1; renderPage(); });
      applyFilters();
    }

    initDiary();
  </script>
</body>
</html>
